/* =====================================================
   THEMES â€” Theme definitions and switcher
   ===================================================== */
window.IDE = window.IDE || {};

IDE.themes = (() => {
  'use strict';

  const THEMES = {
    dark: {
      name: 'Catppuccin Mocha',
      vars: {
        '--bg-primary': '#1e1e2e',
        '--bg-secondary': '#181825',
        '--bg-panel': '#1e1e2e',
        '--bg-input': '#313244',
        '--bg-hover': '#45475a',
        '--bg-active': '#585b70',
        '--border': '#45475a',
        '--border-light': '#585b70',
        '--accent': '#cba6f7',
        '--accent2': '#89b4fa',
        '--accent3': '#f9e2af',
        '--text': '#cdd6f4',
        '--text-muted': '#6c7086',
        '--text-dim': '#585b70',
        '--success': '#a6e3a1',
        '--warning': '#f9e2af',
        '--danger': '#f38ba8',
        '--green': '#a6e3a1',
        '--red': '#f38ba8',
        '--orange': '#fab387',
        '--cyan': '#89dceb',
        '--pink': '#f5c2e7',
        '--yellow': '#f9e2af',
        '--blue': '#89b4fa',
        '--mauve': '#cba6f7',
        /* syntax */
        '--syn-keyword': '#cba6f7',
        '--syn-string': '#a6e3a1',
        '--syn-number': '#fab387',
        '--syn-comment': '#6c7086',
        '--syn-function': '#89b4fa',
        '--syn-class': '#f9e2af',
        '--syn-builtin': '#89dceb',
        '--syn-operator': '#89dceb',
        '--syn-decorator': '#f5c2e7',
        '--syn-variable': '#cdd6f4',
        '--syn-def': '#89b4fa',
        '--syn-self': '#f38ba8',
        '--syn-bool': '#fab387',
        '--editor-bg': '#1e1e2e',
        '--editor-gutter': '#181825',
        '--editor-line-active': 'rgba(69, 71, 90, 0.3)',
        '--editor-selection': 'rgba(137, 180, 250, 0.2)',
        '--editor-cursor': '#f5e0dc',
        '--scrollbar-thumb': '#45475a',
        '--scrollbar-track': '#1e1e2e',
        '--tab-active-bg': '#1e1e2e',
        '--tab-inactive-bg': '#181825',
        '--tab-border': '#45475a',
        '--menu-bg': '#1e1e2e',
        '--menu-hover': '#45475a',
        '--status-bg': '#181825',
        '--splash-bg': '#11111b'
      }
    },
    dracula: {
      name: 'Dracula',
      vars: {
        '--bg-primary': '#282a36',
        '--bg-secondary': '#21222c',
        '--bg-panel': '#282a36',
        '--bg-input': '#44475a',
        '--bg-hover': '#44475a',
        '--bg-active': '#6272a4',
        '--border': '#44475a',
        '--border-light': '#6272a4',
        '--accent': '#bd93f9',
        '--accent2': '#8be9fd',
        '--accent3': '#f1fa8c',
        '--text': '#f8f8f2',
        '--text-muted': '#6272a4',
        '--text-dim': '#44475a',
        '--success': '#50fa7b',
        '--warning': '#f1fa8c',
        '--danger': '#ff5555',
        '--green': '#50fa7b',
        '--red': '#ff5555',
        '--orange': '#ffb86c',
        '--cyan': '#8be9fd',
        '--pink': '#ff79c6',
        '--yellow': '#f1fa8c',
        '--blue': '#8be9fd',
        '--mauve': '#bd93f9',
        '--syn-keyword': '#ff79c6',
        '--syn-string': '#f1fa8c',
        '--syn-number': '#bd93f9',
        '--syn-comment': '#6272a4',
        '--syn-function': '#50fa7b',
        '--syn-class': '#8be9fd',
        '--syn-builtin': '#8be9fd',
        '--syn-operator': '#ff79c6',
        '--syn-decorator': '#50fa7b',
        '--syn-variable': '#f8f8f2',
        '--syn-def': '#50fa7b',
        '--syn-self': '#bd93f9',
        '--syn-bool': '#bd93f9',
        '--editor-bg': '#282a36',
        '--editor-gutter': '#21222c',
        '--editor-line-active': 'rgba(68, 71, 90, 0.4)',
        '--editor-selection': 'rgba(139, 233, 253, 0.2)',
        '--editor-cursor': '#f8f8f2',
        '--scrollbar-thumb': '#44475a',
        '--scrollbar-track': '#282a36',
        '--tab-active-bg': '#282a36',
        '--tab-inactive-bg': '#21222c',
        '--tab-border': '#44475a',
        '--menu-bg': '#282a36',
        '--menu-hover': '#44475a',
        '--status-bg': '#21222c',
        '--splash-bg': '#1e1f29'
      }
    },
    monokai: {
      name: 'Monokai',
      vars: {
        '--bg-primary': '#272822',
        '--bg-secondary': '#1e1f1c',
        '--bg-panel': '#272822',
        '--bg-input': '#3e3d32',
        '--bg-hover': '#49483e',
        '--bg-active': '#75715e',
        '--border': '#3e3d32',
        '--border-light': '#49483e',
        '--accent': '#f92672',
        '--accent2': '#66d9ef',
        '--accent3': '#e6db74',
        '--text': '#f8f8f2',
        '--text-muted': '#75715e',
        '--text-dim': '#49483e',
        '--success': '#a6e22e',
        '--warning': '#e6db74',
        '--danger': '#f92672',
        '--green': '#a6e22e',
        '--red': '#f92672',
        '--orange': '#fd971f',
        '--cyan': '#66d9ef',
        '--pink': '#f92672',
        '--yellow': '#e6db74',
        '--blue': '#66d9ef',
        '--mauve': '#ae81ff',
        '--syn-keyword': '#f92672',
        '--syn-string': '#e6db74',
        '--syn-number': '#ae81ff',
        '--syn-comment': '#75715e',
        '--syn-function': '#a6e22e',
        '--syn-class': '#66d9ef',
        '--syn-builtin': '#66d9ef',
        '--syn-operator': '#f92672',
        '--syn-decorator': '#a6e22e',
        '--syn-variable': '#f8f8f2',
        '--syn-def': '#a6e22e',
        '--syn-self': '#fd971f',
        '--syn-bool': '#ae81ff',
        '--editor-bg': '#272822',
        '--editor-gutter': '#1e1f1c',
        '--editor-line-active': 'rgba(62, 61, 50, 0.5)',
        '--editor-selection': 'rgba(102, 217, 239, 0.2)',
        '--editor-cursor': '#f8f8f2',
        '--scrollbar-thumb': '#49483e',
        '--scrollbar-track': '#272822',
        '--tab-active-bg': '#272822',
        '--tab-inactive-bg': '#1e1f1c',
        '--tab-border': '#3e3d32',
        '--menu-bg': '#272822',
        '--menu-hover': '#49483e',
        '--status-bg': '#1e1f1c',
        '--splash-bg': '#1a1b16'
      }
    },
    nord: {
      name: 'Nord',
      vars: {
        '--bg-primary': '#2e3440',
        '--bg-secondary': '#242933',
        '--bg-panel': '#2e3440',
        '--bg-input': '#3b4252',
        '--bg-hover': '#434c5e',
        '--bg-active': '#4c566a',
        '--border': '#3b4252',
        '--border-light': '#434c5e',
        '--accent': '#88c0d0',
        '--accent2': '#81a1c1',
        '--accent3': '#ebcb8b',
        '--text': '#eceff4',
        '--text-muted': '#4c566a',
        '--text-dim': '#434c5e',
        '--success': '#a3be8c',
        '--warning': '#ebcb8b',
        '--danger': '#bf616a',
        '--green': '#a3be8c',
        '--red': '#bf616a',
        '--orange': '#d08770',
        '--cyan': '#8fbcbb',
        '--pink': '#b48ead',
        '--yellow': '#ebcb8b',
        '--blue': '#81a1c1',
        '--mauve': '#b48ead',
        '--syn-keyword': '#81a1c1',
        '--syn-string': '#a3be8c',
        '--syn-number': '#b48ead',
        '--syn-comment': '#616e88',
        '--syn-function': '#88c0d0',
        '--syn-class': '#8fbcbb',
        '--syn-builtin': '#88c0d0',
        '--syn-operator': '#81a1c1',
        '--syn-decorator': '#d08770',
        '--syn-variable': '#eceff4',
        '--syn-def': '#88c0d0',
        '--syn-self': '#bf616a',
        '--syn-bool': '#b48ead',
        '--editor-bg': '#2e3440',
        '--editor-gutter': '#242933',
        '--editor-line-active': 'rgba(59, 66, 82, 0.5)',
        '--editor-selection': 'rgba(136, 192, 208, 0.2)',
        '--editor-cursor': '#d8dee9',
        '--scrollbar-thumb': '#434c5e',
        '--scrollbar-track': '#2e3440',
        '--tab-active-bg': '#2e3440',
        '--tab-inactive-bg': '#242933',
        '--tab-border': '#3b4252',
        '--menu-bg': '#2e3440',
        '--menu-hover': '#3b4252',
        '--status-bg': '#242933',
        '--splash-bg': '#1d2128'
      }
    },
    solarized: {
      name: 'Solarized Dark',
      vars: {
        '--bg-primary': '#002b36',
        '--bg-secondary': '#073642',
        '--bg-panel': '#002b36',
        '--bg-input': '#073642',
        '--bg-hover': '#586e75',
        '--bg-active': '#657b83',
        '--border': '#073642',
        '--border-light': '#586e75',
        '--accent': '#268bd2',
        '--accent2': '#2aa198',
        '--accent3': '#b58900',
        '--text': '#839496',
        '--text-muted': '#586e75',
        '--text-dim': '#073642',
        '--success': '#859900',
        '--warning': '#b58900',
        '--danger': '#dc322f',
        '--green': '#859900',
        '--red': '#dc322f',
        '--orange': '#cb4b16',
        '--cyan': '#2aa198',
        '--pink': '#d33682',
        '--yellow': '#b58900',
        '--blue': '#268bd2',
        '--mauve': '#6c71c4',
        '--syn-keyword': '#859900',
        '--syn-string': '#2aa198',
        '--syn-number': '#d33682',
        '--syn-comment': '#586e75',
        '--syn-function': '#268bd2',
        '--syn-class': '#b58900',
        '--syn-builtin': '#268bd2',
        '--syn-operator': '#859900',
        '--syn-decorator': '#cb4b16',
        '--syn-variable': '#839496',
        '--syn-def': '#268bd2',
        '--syn-self': '#dc322f',
        '--syn-bool': '#d33682',
        '--editor-bg': '#002b36',
        '--editor-gutter': '#073642',
        '--editor-line-active': 'rgba(7, 54, 66, 0.8)',
        '--editor-selection': 'rgba(38, 139, 210, 0.2)',
        '--editor-cursor': '#839496',
        '--scrollbar-thumb': '#586e75',
        '--scrollbar-track': '#002b36',
        '--tab-active-bg': '#002b36',
        '--tab-inactive-bg': '#073642',
        '--tab-border': '#073642',
        '--menu-bg': '#002b36',
        '--menu-hover': '#073642',
        '--status-bg': '#073642',
        '--splash-bg': '#00212b'
      }
    },
    'github-light': {
      name: 'GitHub Light',
      vars: {
        '--bg-primary': '#ffffff',
        '--bg-secondary': '#f6f8fa',
        '--bg-panel': '#ffffff',
        '--bg-input': '#f6f8fa',
        '--bg-hover': '#f3f4f6',
        '--bg-active': '#e5e7eb',
        '--border': '#d0d7de',
        '--border-light': '#d0d7de',
        '--accent': '#0969da',
        '--accent2': '#8250df',
        '--accent3': '#bf8700',
        '--text': '#1f2328',
        '--text-muted': '#656d76',
        '--text-dim': '#d0d7de',
        '--success': '#1a7f37',
        '--warning': '#bf8700',
        '--danger': '#cf222e',
        '--green': '#1a7f37',
        '--red': '#cf222e',
        '--orange': '#bc4c00',
        '--cyan': '#0969da',
        '--pink': '#8250df',
        '--yellow': '#bf8700',
        '--blue': '#0969da',
        '--mauve': '#8250df',
        '--syn-keyword': '#cf222e',
        '--syn-string': '#0a3069',
        '--syn-number': '#0550ae',
        '--syn-comment': '#6e7781',
        '--syn-function': '#8250df',
        '--syn-class': '#953800',
        '--syn-builtin': '#0550ae',
        '--syn-operator': '#cf222e',
        '--syn-decorator': '#8250df',
        '--syn-variable': '#1f2328',
        '--syn-def': '#8250df',
        '--syn-self': '#cf222e',
        '--syn-bool': '#0550ae',
        '--editor-bg': '#ffffff',
        '--editor-gutter': '#f6f8fa',
        '--editor-line-active': 'rgba(234, 238, 242, 0.5)',
        '--editor-selection': 'rgba(9, 105, 218, 0.15)',
        '--editor-cursor': '#1f2328',
        '--scrollbar-thumb': '#d0d7de',
        '--scrollbar-track': '#f6f8fa',
        '--tab-active-bg': '#ffffff',
        '--tab-inactive-bg': '#f6f8fa',
        '--tab-border': '#d0d7de',
        '--menu-bg': '#ffffff',
        '--menu-hover': '#f3f4f6',
        '--status-bg': '#f6f8fa',
        '--splash-bg': '#f6f8fa'
      }
    },
    'one-dark': {
      name: 'One Dark',
      vars: {
        '--bg-primary': '#282c34',
        '--bg-secondary': '#21252b',
        '--bg-panel': '#282c34',
        '--bg-input': '#3a3f4b',
        '--bg-hover': '#3a3f4b',
        '--bg-active': '#4b5263',
        '--border': '#3a3f4b',
        '--border-light': '#4b5263',
        '--accent': '#61afef',
        '--accent2': '#c678dd',
        '--accent3': '#e5c07b',
        '--text': '#abb2bf',
        '--text-muted': '#5c6370',
        '--text-dim': '#3a3f4b',
        '--success': '#98c379',
        '--warning': '#e5c07b',
        '--danger': '#e06c75',
        '--green': '#98c379',
        '--red': '#e06c75',
        '--orange': '#d19a66',
        '--cyan': '#56b6c2',
        '--pink': '#c678dd',
        '--yellow': '#e5c07b',
        '--blue': '#61afef',
        '--mauve': '#c678dd',
        '--syn-keyword': '#c678dd',
        '--syn-string': '#98c379',
        '--syn-number': '#d19a66',
        '--syn-comment': '#5c6370',
        '--syn-function': '#61afef',
        '--syn-class': '#e5c07b',
        '--syn-builtin': '#56b6c2',
        '--syn-operator': '#56b6c2',
        '--syn-decorator': '#d19a66',
        '--syn-variable': '#abb2bf',
        '--syn-def': '#61afef',
        '--syn-self': '#e06c75',
        '--syn-bool': '#d19a66',
        '--editor-bg': '#282c34',
        '--editor-gutter': '#21252b',
        '--editor-line-active': 'rgba(58, 63, 75, 0.4)',
        '--editor-selection': 'rgba(97, 175, 239, 0.2)',
        '--editor-cursor': '#528bff',
        '--scrollbar-thumb': '#3a3f4b',
        '--scrollbar-track': '#282c34',
        '--tab-active-bg': '#282c34',
        '--tab-inactive-bg': '#21252b',
        '--tab-border': '#3a3f4b',
        '--menu-bg': '#282c34',
        '--menu-hover': '#3a3f4b',
        '--status-bg': '#21252b',
        '--splash-bg': '#1b1f27'
      }
    }
  };

  let currentTheme = localStorage.getItem('ide-theme') || 'dark';

  function apply(themeId) {
    const theme = THEMES[themeId];
    if (!theme) return;
    currentTheme = themeId;
    const root = document.documentElement;
    for (const [prop, val] of Object.entries(theme.vars)) {
      root.style.setProperty(prop, val);
    }
    document.body.setAttribute('data-theme', themeId);
    localStorage.setItem('ide-theme', themeId);
    IDE.utils.emit('theme-changed', themeId);
  }

  function current() { return currentTheme; }

  function list() {
    return Object.entries(THEMES).map(([id, t]) => ({ id, name: t.name }));
  }

  function init() {
    apply(currentTheme);
  }

  return { apply, current, list, init, THEMES };
})();
